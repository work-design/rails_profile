<%= content_for(:wechat_js) do %>
  <%= wechat_config_js debug: false, apis: ['openAddress', 'getLocation', 'openLocation', 'scanQRCode'] -%>
  <meta name="turbo-visit-control" content="reload">
<% end %>

<div class="weui-panel" id="wechat_panel">
  <div class="weui-panel__hd level is-flex mb-0">
    <div class="level-left"><%= t('.title') %></div>
    <div class="level-right mt-0">
      <%= link_to '选择', { action: 'list' } %>
    </div>
  </div>
  <div class="weui-panel__bd">
    <%= render partial: 'address', collection: @addresses, as: :model %>
  </div>
  <div class="weui-panel__ft" data-controller="wechat" data-wechat-address-value="/pages/profiled/my/addresses/index?url=<%= url_for(action: 'program', only_path: false) %>" data-wechat-url-value="<%= url_for(action: 'fork', only_path: false) %>" id="wechat_address">
    <div class="weui-cell weui-cell_access weui-cell_link" data-action="click->wechat#openAddress">
      <div class="weui-cell__bd"><%= t('.new') %></div>
      <span class="weui-cell__ft"></span>
    </div>
    <%= link_to({ action: 'new' }, class: 'weui-cell weui-cell_access weui-cell_link') do %>
      <div class="weui-cell__bd">手动添加</div>
      <span class="weui-cell__ft"></span>
    <% end %>
  </div>
</div>
